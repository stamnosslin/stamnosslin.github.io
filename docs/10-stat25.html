<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; S: Linear Regression: Single Predictor – RMS notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11-method25.html" rel="next">
<link href="./09-method25.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="mnstyle.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-stat25.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">S: Linear Regression: Single Predictor</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">RMS notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-method25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">M: Research Questions and Claims</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-stat25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">S: Data Management and Screening</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-method25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">M: Tools for Thinking About Causality</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-stat25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">S: Descriptive Statistics and Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-method25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">M: Measurement and Data Quality</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-stat25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">S: Point Estimates and Their Uncertainty</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-method25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">M: Within-participant Experiments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-stat25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">S: Linear Regression: Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-method25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">M: Randomized Experiments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-stat25.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">S: Linear Regression: Single Predictor</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-method25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">M: Broken Experiments and Quasi-experiments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-stat25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">S: Linear Regression: Multiple Predictors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-method25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">M: Observational studies</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-stat25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">S: Linear Regression: Non-linear Transformations and Interactions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-method25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">M: Fallacies and paradoxes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-stat25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">S: Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#topics" id="toc-topics" class="nav-link active" data-scroll-target="#topics">Topics</a>
  <ul class="collapse">
  <li><a href="#data-set-kidiq.txt" id="toc-data-set-kidiq.txt" class="nav-link" data-scroll-target="#data-set-kidiq.txt">Data set kidiq.txt</a></li>
  </ul></li>
  <li><a href="#intercept-only-model" id="toc-intercept-only-model" class="nav-link" data-scroll-target="#intercept-only-model"><span class="header-section-number">10.1</span> Intercept-only model</a>
  <ul class="collapse">
  <li><a href="#estimating-the-mean-is-the-same-as-regressing-on-a-constant-term" id="toc-estimating-the-mean-is-the-same-as-regressing-on-a-constant-term" class="nav-link" data-scroll-target="#estimating-the-mean-is-the-same-as-regressing-on-a-constant-term">Estimating the mean is the same as regressing on a constant term</a></li>
  </ul></li>
  <li><a href="#indicator-variables" id="toc-indicator-variables" class="nav-link" data-scroll-target="#indicator-variables"><span class="header-section-number">10.2</span> Indicator variables</a>
  <ul class="collapse">
  <li><a href="#estimating-a-difference-between-two-means-is-the-same-as-regressing-on-an-indicator-variable" id="toc-estimating-a-difference-between-two-means-is-the-same-as-regressing-on-an-indicator-variable" class="nav-link" data-scroll-target="#estimating-a-difference-between-two-means-is-the-same-as-regressing-on-an-indicator-variable">Estimating a difference between two means is the same as regressing on an indicator variable</a></li>
  </ul></li>
  <li><a href="#categorical-variables" id="toc-categorical-variables" class="nav-link" data-scroll-target="#categorical-variables"><span class="header-section-number">10.3</span> Categorical variables</a>
  <ul class="collapse">
  <li><a href="#estimating-differences-between-several-means-is-the-same-as-regressing-on-a-categorical-variable" id="toc-estimating-differences-between-several-means-is-the-same-as-regressing-on-a-categorical-variable" class="nav-link" data-scroll-target="#estimating-differences-between-several-means-is-the-same-as-regressing-on-a-categorical-variable">Estimating differences between several means is the same as regressing on a categorical variable</a></li>
  </ul></li>
  <li><a href="#one-continous-predictor" id="toc-one-continous-predictor" class="nav-link" data-scroll-target="#one-continous-predictor"><span class="header-section-number">10.4</span> One continous predictor</a>
  <ul class="collapse">
  <li><a href="#centering-of-predictor-to-make-intercept-meaningful" id="toc-centering-of-predictor-to-make-intercept-meaningful" class="nav-link" data-scroll-target="#centering-of-predictor-to-make-intercept-meaningful">Centering of predictor to make intercept meaningful</a></li>
  </ul></li>
  <li><a href="#advanced-parameterization" id="toc-advanced-parameterization" class="nav-link" data-scroll-target="#advanced-parameterization"><span class="header-section-number">10.5</span> Advanced: Parameterization</a></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice">Practice</a>
  <ul class="collapse">
  <li><a href="#easy" id="toc-easy" class="nav-link" data-scroll-target="#easy">Easy</a></li>
  <li><a href="#medium" id="toc-medium" class="nav-link" data-scroll-target="#medium">Medium</a></li>
  <li><a href="#hard" id="toc-hard" class="nav-link" data-scroll-target="#hard">Hard</a></li>
  </ul></li>
  <li><a href="#data-set-earnings.txt" id="toc-data-set-earnings.txt" class="nav-link" data-scroll-target="#data-set-earnings.txt">Data set earnings.txt</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">(Session Info)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">S: Linear Regression: Single Predictor</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Load R-libraries</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the library "rstanarm" to fit Bayesian linear models using the function  </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># stan_glm() </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="topics" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="topics">Topics</h2>
<div class="concepts">
<ul>
<li>Estimating the mean is the same as regressing on a constant term <span class="citation" data-cites="gelman2020regression">(<a href="references.html#ref-gelman2020regression" role="doc-biblioref">Gelman et al., 2021, p. 99</a>)</span></li>
<li>Indicator variables</li>
<li>Estimating a difference between two means is the same as regressing on an indicator variable <span class="citation" data-cites="gelman2020regression">(<a href="references.html#ref-gelman2020regression" role="doc-biblioref">Gelman et al., 2021, p. 100</a>)</span></li>
<li>Categorical variables</li>
<li>Estimating differences between several means is the same as regressing on a categorical variable</li>
<li>One continuous predictor
<ul>
<li>interpretation of intercept and slope</li>
<li>centering of predictor to make intercept meaningful</li>
</ul></li>
<li>(Parameterization)</li>
</ul>
<p>Readings.</p>
<ul>
<li><span class="citation" data-cites="gelman2020regression">Gelman et al. (<a href="references.html#ref-gelman2020regression" role="doc-biblioref">2021</a>)</span>, Chapter 7-8, Chapter 9, section 9.1<br>
</li>
</ul>
</div>
<p><br></p>
<p>Today we will fit linear models with no or one predictor:</p>
<ul>
<li><strong>No predictor</strong>. Estimating the mean and CI of a variable.</li>
<li><strong>One indicator-variable predictor</strong>. Estimating the mean difference and CI between two groups of observations.</li>
<li><strong>One categorical-variable predictor</strong>. Estimating the mean difference and CI between several groups of observations.</li>
<li><strong>One continuous predictor</strong>s. Estimating the slope of a linear relationship, i.e.&nbsp; the difference in means between groups differing with one unit on the predictor.</li>
</ul>
<p>We will illustrate this using data the data set <code>kidiq</code> described below, using <code>kid_score</code> as outcome variable.</p>
<p><br></p>
<section id="data-set-kidiq.txt" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="data-set-kidiq.txt">Data set kidiq.txt</h3>
<p>We will use the data set in <code>kidiq.txt</code> to illustrate several points below. The data is from a survey of adult American women and their children. <span class="citation" data-cites="gelman2020regression">Gelman et al. (<a href="references.html#ref-gelman2020regression" role="doc-biblioref">2021</a>)</span> describe the data set and use it at several places, e.g., pp.&nbsp;130-136, 156-158, 161, 185-187, and 197.</p>
<p>Code book:</p>
<ul>
<li><strong>kid_score</strong> &nbsp;Test score children, on IQ-like measure (in the sample with mean and standard deviation of 87 and 20 points, respectively).</li>
<li><strong>mom_hs</strong> &nbsp;Indicator variable: mother did complete high-school (1) or not (0)</li>
<li><strong>mom_iq</strong> &nbsp;Test score mothers, transformed to IQ score: mean = 100, sd = 15.</li>
<li><strong>mom_work</strong> &nbsp;Working status of mother, coded 1-4:
<ul>
<li>1: mother did not work in first three years of child’s life,</li>
<li>2: mother worked in second or third year of child’s life,</li>
<li>3: mother worked part-time in first year of child’s life,</li>
<li>4: mother worked full-time in first year of child’s life.</li>
</ul></li>
<li><strong>mom_age</strong> Age of mothers, years</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"./datasets/kidiq.txt"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   434 obs. of  5 variables:
 $ kid_score: int  65 98 85 83 115 98 69 106 102 95 ...
 $ mom_hs   : int  1 1 1 1 1 0 1 1 1 1 ...
 $ mom_iq   : num  121.1 89.4 115.4 99.4 92.7 ...
 $ mom_work : int  4 4 4 3 4 1 4 3 1 1 ...
 $ mom_age  : int  27 25 27 25 27 18 20 23 24 19 ...</code></pre>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="intercept-only-model" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="intercept-only-model"><span class="header-section-number">10.1</span> Intercept-only model</h2>
<section id="estimating-the-mean-is-the-same-as-regressing-on-a-constant-term" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="estimating-the-mean-is-the-same-as-regressing-on-a-constant-term">Estimating the mean is the same as regressing on a constant term</h3>
<p>Regression analysis can be used to estimate a population mean and standard deviation from a sample, suing an intercept-only model:</p>
<p><span class="math inline">\(y_i \sim N(\mu, \sigma)\)</span><br>
<span class="math inline">\(\mu = b_0\)</span>, where <span class="math inline">\(b_0\)</span> is a constant (intercept).</p>
<p>Sample size, mean and standard deviation for the kid_score variable:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sample_stats <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">n =</span> <span class="fu">length</span>(d<span class="sc">$</span>kid_score), <span class="at">mean =</span> <span class="fu">mean</span>(d<span class="sc">$</span>kid_score), </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(d<span class="sc">$</span>kid_score))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(sample_stats, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    n  mean    sd 
434.0  86.8  20.4 </code></pre>
</div>
</div>
<p>Here is estimates of population <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, using <code>stan_glm()</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> d, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      kid_score ~ 1
 observations: 434
 predictors:   1
------
            Median MAD_SD
(Intercept) 86.8    1.0  

Auxiliary parameter(s):
      Median MAD_SD
sigma 20.4    0.7  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_interval</span>(m0, <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5%    97.5%
(Intercept) 84.81816 88.74237
sigma       19.13409 21.85210</code></pre>
</div>
</div>
<p>Try <code>lm()</code>, it gives very similar estimates, but it does not provide a compatibility interval around <span class="math inline">\(\sigma\)</span>.</p>
<p><br></p>
</section>
</section>
<section id="indicator-variables" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="indicator-variables"><span class="header-section-number">10.2</span> Indicator variables</h2>
<p>Indicator variables are coded 1 (presence of something) and 0 (absence). In the <code>kidIQ</code> data, <code>moms_hs</code> is an indicator variable coded 1 if the mother completed high school and 0 otherwise. The mean of an indicator variable is the proportion of 1’s, so the mean of <code>mom_hs</code> is the proportion of mothers who completed high-school.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot frequncy table</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(d<span class="sc">$</span>mom_hs), </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Indicator: mom_hs</span><span class="sc">\n</span><span class="st">0 = high-school not completed</span><span class="sc">\n</span><span class="st">1 = completed"</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Frequencies: mom_hs"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">434</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot proprtion table</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(d<span class="sc">$</span>mom_hs)<span class="sc">/</span><span class="fu">length</span>(d<span class="sc">$</span>mom_hs),  <span class="co"># Proportions</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Indicator: mom_hs</span><span class="sc">\n</span><span class="st">0 = high-school not completed</span><span class="sc">\n</span><span class="st">1 = completed"</span>, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Proprtions: mom_hs"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-stat25_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>mom_hs) <span class="co"># Frequency table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
 93 341 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">table</span>(d<span class="sc">$</span>mom_hs)<span class="sc">/</span><span class="fu">length</span>(d<span class="sc">$</span>mom_hs), <span class="dv">3</span>)  <span class="co"># Proportions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    0     1 
0.214 0.786 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(d<span class="sc">$</span>mom_hs), <span class="dv">3</span>)  <span class="co"># Mean indicator should be the same as proportion 1's</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.786</code></pre>
</div>
</div>
<p><br></p>
<section id="estimating-a-difference-between-two-means-is-the-same-as-regressing-on-an-indicator-variable" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="estimating-a-difference-between-two-means-is-the-same-as-regressing-on-an-indicator-variable">Estimating a difference between two means is the same as regressing on an indicator variable</h3>
<p>Consider this model:</p>
<p><span class="math inline">\(y_i \sim N(\mu_i, \sigma)\)</span><br>
<span class="math inline">\(\mu_i = b_0 + b_1D_i\)</span>, where <span class="math inline">\(D_i\)</span> is an indicator variable coded 0 or 1.</p>
<p>The interpretation of the coefficients is simple:</p>
<ul>
<li><span class="math inline">\(b_0\)</span> is the mean of <span class="math inline">\(y_i\)</span> for observations for which <span class="math inline">\(D = 0\)</span>.
<ul>
<li>That is, <span class="math inline">\(b_0 = Mean(y_i | D = 0)\)</span></li>
</ul></li>
<li><span class="math inline">\(b_1\)</span> is the difference in mean <span class="math inline">\(y_i\)</span> between observations for which <span class="math inline">\(D = 1\)</span> and <span class="math inline">\(D = 0\)</span>.
<ul>
<li>That is, <span class="math inline">\(b_1 = Mean(y_i | D = 1) - Mean(y_i | D = 0)\)</span>,</li>
<li>so, <span class="math inline">\(Mean(y_i | D = 1) = b_0 + b_1\)</span></li>
</ul></li>
<li><span class="math inline">\(\sigma\)</span> is the standard deviation of observations, assumed to be equal for observations in each group (homoscedasticity)</li>
</ul>
<p><br></p>
<p>Here applied to outcome variable kid_score (<span class="math inline">\(y_i\)</span>) and indicator variable moms_hs (<span class="math inline">\(D_i\)</span>):</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: stan_glm() is a method based on data simulation, the seed argument set </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the random number generator</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_hs, <span class="at">data =</span> d, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      kid_score ~ mom_hs
 observations: 434
 predictors:   2
------
            Median MAD_SD
(Intercept) 77.5    2.0  
mom_hs      11.8    2.3  

Auxiliary parameter(s):
      Median MAD_SD
sigma 19.9    0.7  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_interval</span>(m1, <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5%    97.5%
(Intercept) 73.40918 81.54022
mom_hs       7.26764 16.36398
sigma       18.64532 21.28927</code></pre>
</div>
</div>
<p>Interpretation: On average, kids to mothers who completed high-school had 12 points higher scores than kids to mothers who did not complete high-school. Our data is compatible with a difference in the population between about 7 - 16 points, given the assumptions of our statistical model (independent observations, normal distributions with equal standard deviations).</p>
<p><br></p>
</section>
</section>
<section id="categorical-variables" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="categorical-variables"><span class="header-section-number">10.3</span> Categorical variables</h2>
<p>Categorical variables code membership in categories for nominal scale variables. In the <code>kidIQ</code> data, the variable <code>mom_work</code> is a nominal variable coding the amount of work of mothers during their kid’s first three years. It is coded 1, 2, 3, and 4 for the four categories described above in the code book. This is a nominal scale value, although it can be discussed whether it also can be interpreted as an ordinal scale, from the least to the most amount of work during the first three years of child’s life (more information would be needed on the definition of the variable to decide this).</p>
<p>The categorical variable <code>mom_work</code> could be coded as three indicator variables, for example:</p>
<ul>
<li><span class="math inline">\(D_2\)</span> coded 1 if <code>mom_work</code> = 2 and 0 otherwise,</li>
<li><span class="math inline">\(D_3\)</span> coded 1 if <code>mom_work</code> = 3 and 0 otherwise, and</li>
<li><span class="math inline">\(D_4\)</span> coded 1 if <code>mom_work</code> = 4 and 0 otherwise.</li>
</ul>
<p>The first category, <code>mom_work</code> = 1, would be implied for observations for which <span class="math inline">\(D_2 = D_3 = D_4 = 0\)</span>. In general, a categorical variable with <span class="math inline">\(k\)</span> categories can be coded with <span class="math inline">\(k-1\)</span> indicator variables. However, in <code>R</code> it is possible to use a categorical variable (<code>factor</code>) to obtain the same thing. Here a boxplot of <code>kid_score</code> for each category of <code>mom_work</code></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make mom_work a factor, and add labels (labels not needed, but helpful)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>mom_work_f <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>mom_work, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1_no"</span>, <span class="st">"2_only_y2_y3"</span>,<span class="st">"3_part_y1"</span>, <span class="st">"4_full_y1"</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>kid_score <span class="sc">~</span> d<span class="sc">$</span>mom_work_f, <span class="at">xlab =</span> <span class="st">"Categorical variable: mom_work"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Kids score on intelligence test"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-stat25_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<section id="estimating-differences-between-several-means-is-the-same-as-regressing-on-a-categorical-variable" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="estimating-differences-between-several-means-is-the-same-as-regressing-on-a-categorical-variable">Estimating differences between several means is the same as regressing on a categorical variable</h3>
<p><code>R</code> will analyse a categorical variable (<code>factor</code>) with <span class="math inline">\(k\)</span> categories as an analysis with <span class="math inline">\(k-1\)</span> indicator variables. The analysis will estimate one regression coefficient for each category except the first category (reference). The regression coefficients refer to the mean difference between the group defined by the category and the group defined by the reference category. The intercept estimates the mean of the reference category.</p>
<p>Here an example predicting <code>kid_score</code> from <code>mom_work</code> using <code>stan_glm()</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use factor, defined previous code block</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_work_f, <span class="at">data =</span> d, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      kid_score ~ mom_work_f
 observations: 434
 predictors:   4
------
                       Median MAD_SD
(Intercept)            82.1    2.3  
mom_work_f2_only_y2_y3  3.7    3.1  
mom_work_f3_part_y1    11.4    3.5  
mom_work_f4_full_y1     5.2    2.6  

Auxiliary parameter(s):
      Median MAD_SD
sigma 20.3    0.7  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_interval</span>(m2, <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             2.5%     97.5%
(Intercept)            77.4093836 86.486748
mom_work_f2_only_y2_y3 -2.3954141  9.963632
mom_work_f3_part_y1     4.3567994 18.604737
mom_work_f4_full_y1    -0.1811025 10.592623
sigma                  18.9977610 21.716944</code></pre>
</div>
</div>
<p>The reference category (1: no work) had a mean of around 82 points. Categories 2, 3, and, 4 had higher scores the first category, about 4, 11, and 5 points, respectively.</p>
<p>You can change the reference category by redefining the factor:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make 4: full-time work the reference category. </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>mom_work_f <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>mom_work, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"4_full_y1"</span>, <span class="st">"1_no"</span>, <span class="st">"2_only_y2_y3"</span>,<span class="st">"3_part_y1"</span>))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_work_f, <span class="at">data =</span> d, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      kid_score ~ mom_work_f
 observations: 434
 predictors:   4
------
                       Median MAD_SD
(Intercept)            87.2    1.4  
mom_work_f1_no         -5.2    2.8  
mom_work_f2_only_y2_y3 -1.4    2.5  
mom_work_f3_part_y1     6.3    3.1  

Auxiliary parameter(s):
      Median MAD_SD
sigma 20.2    0.7  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
</div>
<p>The reference category (4: full time work) had a mean of around 87 points. Categories 1 and 2 had lower scores than category 4, whereas category 3 had higher scores.</p>
<p><br></p>
</section>
</section>
<section id="one-continous-predictor" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="one-continous-predictor"><span class="header-section-number">10.4</span> One continous predictor</h2>
<p>Estimating the relationship between Mothers IQ-score (<code>mom_iq</code>) and <code>kid_score</code></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> d, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      kid_score ~ mom_iq
 observations: 434
 predictors:   2
------
            Median MAD_SD
(Intercept) 25.8    5.9  
mom_iq       0.6    0.1  

Auxiliary parameter(s):
      Median MAD_SD
sigma 18.3    0.6  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
</div>
<p><br></p>
<p>Plot data and model prediction</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>mom_iq, d<span class="sc">$</span>kid_score, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Mother's IQ-score"</span>, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Kid's score on IQ-related measure"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(m3<span class="sc">$</span>coefficients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-stat25_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<section id="centering-of-predictor-to-make-intercept-meaningful" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="centering-of-predictor-to-make-intercept-meaningful">Centering of predictor to make intercept meaningful</h3>
<p>In the model above, the intercept = 25.81 is not meaningful as it refer to the <code>kid_score</code> of a kid to a mother with an IQ-score = 0 (an impossible value). Centering the predictor:</p>
<p><code>d$mom_iq_centered &lt;- d$mom_iq - mean(d$mom_iq)</code></p>
<p>make the intercept meaningful: It is the <code>kid_score</code> of a kid to a mother with a mean IQ-score. Note that the slope remains the same.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the predictor variable</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>mom_iq_centered <span class="ot">&lt;-</span> d<span class="sc">$</span>mom_iq <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>mom_iq)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>m3center <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> d<span class="sc">$</span>mom_iq_centered, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> d, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m3center)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      kid_score ~ d$mom_iq_centered
 observations: 434
 predictors:   2
------
                  Median MAD_SD
(Intercept)       86.8    0.9  
d$mom_iq_centered  0.6    0.1  

Auxiliary parameter(s):
      Median MAD_SD
sigma 18.3    0.6  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>mom_iq_centered, d<span class="sc">$</span>kid_score, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Mother's IQ-score, centered around mean(IQ-score)"</span>, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Kid's score on IQ-related measure"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(m3center<span class="sc">$</span>coefficients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-stat25_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="advanced-parameterization" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="advanced-parameterization"><span class="header-section-number">10.5</span> Advanced: Parameterization</h2>
<p>A model can often be written in several ways, with different sets of parameters. The models, or <em>parameterizations</em>, are mathematically equivalent, but one parameterization may be more useful than another.</p>
<p>As an example, consider these two parameterizations of the same model:</p>
<ul>
<li>m1:
<ul>
<li><span class="math inline">\(y_i \sim N(\mu_i, \sigma)\)</span><br>
</li>
<li><span class="math inline">\(\mu_i = b_0 + b_1D_i\)</span>, where <span class="math inline">\(D_i\)</span> is an indicator variable coded 0 or 1.</li>
</ul></li>
<li>m1b:
<ul>
<li><span class="math inline">\(y_i \sim N(\mu_i, \sigma)\)</span></li>
<li><span class="math inline">\(\mu_i = b_0D_{1i} + b_1D_{2i}\)</span>, where
<ul>
<li><span class="math inline">\(D_{1}\)</span> is an indicator variable where 1 means that the mother did <em>not</em> complete high school,</li>
<li><span class="math inline">\(D_{2}\)</span> is an indicator variable where 1 means that the mother did complete high school.</li>
</ul></li>
</ul></li>
</ul>
<p>In parameterization m1, <span class="math inline">\(b_1\)</span> refer to a difference between means, whereas in m1b, <span class="math inline">\(b_1\)</span> refer to the mean of observations for which <span class="math inline">\(D = 1\)</span>. In both parameterizations, <span class="math inline">\(b_0\)</span> refer to the mean of observations for which <span class="math inline">\(D = 0\)</span>.</p>
<p>If your goal is to estimate group means rather than differences between means,<br>
parameterization m1b may be your choice. Note that m1b still assume equal standard deviations. (If you don’t like this assumption, then just fit an intercept-only model separately to each group of kids.)</p>
<p>Here the two versions of the model are fitted using <code>glm()</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>mom_hs0 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> (d<span class="sc">$</span>mom_hs <span class="sc">==</span> <span class="dv">0</span>)  <span class="co"># New indicator variable</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with intercept and one indicators</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>m1_lm <span class="ot">&lt;-</span> <span class="fu">glm</span>(kid_score <span class="sc">~</span> mom_hs, <span class="at">data =</span> d)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with no intercept and two indicators</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>m1b_lm <span class="ot">&lt;-</span> <span class="fu">glm</span>(kid_score <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> mom_hs0 <span class="sc">+</span> mom_hs, <span class="at">data =</span> d)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Model outputs</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = kid_score ~ mom_hs, data = d)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   77.548      2.059  37.670  &lt; 2e-16 ***
mom_hs        11.771      2.322   5.069 5.96e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 394.1231)

    Null deviance: 180386  on 433  degrees of freedom
Residual deviance: 170261  on 432  degrees of freedom
AIC: 3829.5

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1b_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = kid_score ~ 0 + mom_hs0 + mom_hs, data = d)

Coefficients:
        Estimate Std. Error t value Pr(&gt;|t|)    
mom_hs0   77.548      2.059   37.67   &lt;2e-16 ***
mom_hs    89.320      1.075   83.08   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 394.1231)

    Null deviance: 3450038  on 434  degrees of freedom
Residual deviance:  170261  on 432  degrees of freedom
AIC: 3829.5

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p><br></p>
<p>You may of course do the same thing with <code>stan_glm()</code>. But it may not be necessary, as you can use it’s parameter estimates to derive new parameters. Here an illustration, using parameter estimates from model m1:</p>
<p><span class="math inline">\(y_i \sim N(\mu_i, \sigma)\)</span><br>
<span class="math inline">\(\mu_i = b_0 + b_1D_i\)</span>,</p>
<p>to derive point estimate and 95 % confidence interval for the mean of the group <span class="math inline">\(D = 1\)</span>, that is, <span class="math inline">\(b_0 + b_1\)</span>, for the kidIQ data.</p>
<p>Samples from the posterior:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model using glm_stan()</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_hs, <span class="at">data =</span> d, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save samples from the posterior distribution</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(m1)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(samples) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"b0"</span>, <span class="st">"b1"</span>, <span class="st">"sigma"</span>)  <span class="co"># rename column names</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive new estimate: b0 + b1</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>samples<span class="sc">$</span>mean_g1 <span class="ot">&lt;-</span> samples<span class="sc">$</span>b0 <span class="sc">+</span> samples<span class="sc">$</span>b1</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        b0        b1    sigma  mean_g1
1 79.26794 10.223293 19.09675 89.49123
2 80.57249 10.290838 19.24931 90.86332
3 79.01779  9.521749 19.85170 88.53954
4 76.58362 13.120297 20.32644 89.70392
5 77.75065 12.179655 19.70027 89.93030
6 77.85677 12.065890 19.95251 89.92266</code></pre>
</div>
</div>
<p>Estimates from <code>glm_stan()</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># median and 95 % CI for group 1 (mom_hs = 1)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>g1posterior <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples<span class="sc">$</span>mean_g1, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>g1posterior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    2.5%      50%    97.5% 
87.21719 89.30087 91.43292 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot posterior, with point estimate and 95 % CI</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(samples<span class="sc">$</span>mean_g), <span class="at">main =</span> <span class="st">""</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Estimated mean IQ-score for kids to </span><span class="sc">\n</span><span class="st">mothers with completed high-school"</span>, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Posterior probabbility"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(g1posterior[<span class="dv">1</span>], g1posterior[<span class="dv">3</span>]), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(g1posterior[<span class="dv">2</span>], <span class="fl">0.01</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-stat25_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>The estimated interval is almost identical to the estimates of parameterization m1b using <code>glm()</code> (or <code>stan_glm()</code>)</p>
<p>Estimates from <code>glm(kid_score ~ 0 + mom_hs0 + mom_hs, data = d)</code></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>m1b <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">glm</span>(kid_score <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> mom_hs0 <span class="sc">+</span> mom_hs, <span class="at">data =</span> d))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>point_est <span class="ot">&lt;-</span> m1b<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(point_est) <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>ci95lo <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1b)[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ci95hi <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1b)[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>m1b_estimates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">ci95lo =</span> ci95lo, <span class="at">point_est =</span> point_est, <span class="at">ci95hi =</span> ci95hi)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(m1b_estimates, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   ci95lo point_est    ci95hi 
   87.213    89.320    91.427 </code></pre>
</div>
</div>
<p><br></p>
<p>A similar strategy can be used with categorical variables: by excluding the intercept, regression coefficients refer to mean values for each category. Here illustrated using the four-category variable <code>mom_work</code> as predictor and <code>kid_score</code> as outcome variable, using <code>stan_glm()</code> and <code>lm()</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with no intercept yields estimates of means for each category</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>m2b <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> mom_work_f, <span class="at">data =</span> d, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m2b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      kid_score ~ 0 + mom_work_f
 observations: 434
 predictors:   4
------
                       Median MAD_SD
mom_work_f4_full_y1    87.2    1.5  
mom_work_f1_no         81.9    2.2  
mom_work_f2_only_y2_y3 85.9    2.0  
mom_work_f3_part_y1    93.5    2.6  

Auxiliary parameter(s):
      Median MAD_SD
sigma 20.2    0.7  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>m2b_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> mom_work_f, <span class="at">data =</span> d)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2b_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kid_score ~ 0 + mom_work_f, data = d)

Residuals:
   Min     1Q Median     3Q    Max 
-65.85 -12.85   2.79  14.15  50.50 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
mom_work_f4_full_y1      87.210      1.413   61.72   &lt;2e-16 ***
mom_work_f1_no           82.000      2.305   35.57   &lt;2e-16 ***
mom_work_f2_only_y2_y3   85.854      2.065   41.58   &lt;2e-16 ***
mom_work_f3_part_y1      93.500      2.703   34.59   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 20.23 on 430 degrees of freedom
Multiple R-squared:  0.949, Adjusted R-squared:  0.9485 
F-statistic:  2000 on 4 and 430 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Compare these estimates to the the sample means for each category:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">list</span>(<span class="at">kid_score =</span> d<span class="sc">$</span>kid_score), <span class="fu">list</span>(<span class="at">mom_work =</span> d<span class="sc">$</span>mom_work_f), mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      mom_work kid_score
1    4_full_y1  87.20976
2         1_no  82.00000
3 2_only_y2_y3  85.85417
4    3_part_y1  93.50000</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="practice" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="practice">Practice</h2>
<p>The practice problems are labeled Easy (E), Medium (M), and Hard (H), (as in <span class="citation" data-cites="McElreath2020">McElreath (<a href="references.html#ref-McElreath2020" role="doc-biblioref">2020</a>)</span>).</p>
<section id="easy" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="easy">Easy</h3>
<div class="practice">
<p><strong>10E1.</strong> Load the data in the file <a href="https://bitbucket.org/matni/matni.bitbucket.org/raw/2764bd7e58ab2b24b69cdd82dee3102a8e42283b/rmsnotes/datasets/earnings.txt" target="blank">earnings.txt</a>. It is data from a survey conducted 1990. This data set is used by <span class="citation" data-cites="gelman2020regression">Gelman et al. (<a href="references.html#ref-gelman2020regression" role="doc-biblioref">2021</a>)</span> at several places. Please find a code book for this data set below the Practice section.</p>
<ol type="a">
<li>Weight is given in pounds. Transform it to kilograms, and estimate average weight in the population using regression (intercept-only regression), report point estimate and 90 % compatibility interval.</li>
<li>Make a histogram overlaid with a kernel density estimate of the observed weight [kg], and discuss in relation to assumptions of your model.<br>
</li>
</ol>
</div>
<p><br></p>
<div class="practice">
<p><strong>10E2.</strong> Continue on 10E1, but now estimate the difference in weight between males and females by regressing on an indicator variable. Report point estimate and 90 % compatibility interval.</p>
</div>
<p><br></p>
<div class="practice">
<p><strong>10E3.</strong> Continue on 10E1, but now estimate the difference in weight between groups defined by ethnicity (Blacks, Whites, Hispanics, Other):</p>
<ol type="a">
<li>With Blacks s reference category.</li>
<li>With Whites as reference category.</li>
</ol>
</div>
<p><br></p>
<div class="practice">
<p><strong>10E4.</strong> Below is estimated coefficients from <code>glm()</code>. What does the coefficients refer to?</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"datasets/earnings.txt"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>weight_kg <span class="ot">&lt;-</span> m<span class="sc">$</span>weight <span class="sc">*</span> <span class="fl">0.45359237</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ethnicity_f <span class="ot">&lt;-</span> <span class="fu">factor</span>(m<span class="sc">$</span>ethnicity)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(weight_kg <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> ethnicity_f, <span class="at">data =</span> m)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = weight_kg ~ 0 + ethnicity_f, data = m)

Coefficients:
   ethnicity_fBlack  ethnicity_fHispanic     ethnicity_fOther  
              72.63                68.96                64.91  
   ethnicity_fWhite  
              70.97  

Degrees of Freedom: 1789 Total (i.e. Null);  1785 Residual
  (27 observations deleted due to missingness)
Null Deviance:      9434000 
Residual Deviance: 438600   AIC: 14930</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="medium" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="medium">Medium</h3>
<div class="practice">
<p><strong>10M1.</strong> Below a scatter plot of the relationship between weight [kg] and age [years] from the earnings.txt data (used above in 10E1). The smooth function was added using the <code>loess()</code> function in R.</p>
<ol type="a">
<li><p>Based on the plot and the red line, would linear regression seem useful to estimate the relationship?</p></li>
<li><p>If you could add one additional predictor to reduce the variability around the regression line, which one would you suggest?</p></li>
</ol>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"datasets/earnings.txt"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>weight_kg <span class="ot">&lt;-</span> m<span class="sc">$</span>weight <span class="sc">*</span> <span class="fl">0.45359237</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m<span class="sc">$</span>age, m<span class="sc">$</span>weight_kg, <span class="at">xlab =</span> <span class="st">"Age [years]"</span>, <span class="at">ylab =</span> <span class="st">"Weight [kg]"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit loess() line // lowess() did not work well here for some reason</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>loess_fit <span class="ot">&lt;-</span> <span class="fu">loess</span>(weight_kg <span class="sc">~</span> age, <span class="at">data =</span> m)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="fu">seq</span>(<span class="dv">18</span>, <span class="dv">90</span>, <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(loess_fit, <span class="at">newdata =</span> dd)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(dd<span class="sc">$</span>age, predicted, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-stat25_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<div class="practice">
<p><strong>10M2.</strong> Below a scatter plot of the relationship between weight [kg] and age [years] for males &lt; 50 years old. The line was fitted using linear regression (<code>glm(weight_kg ~ age)</code>).</p>
<ol type="a">
<li>Estimate by eye the intercept and slope of regression line.</li>
<li>The intercept makes little sense (why?), how would you fix that?</li>
</ol>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> m[m<span class="sc">$</span>male <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> (m<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">50</span>), <span class="fu">c</span>(<span class="st">"weight_kg"</span>, <span class="st">"age"</span>)]</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mm<span class="sc">$</span>age, mm<span class="sc">$</span>weight_kg, <span class="at">xlab =</span> <span class="st">"Age [years]"</span>, <span class="at">ylab =</span> <span class="st">"Weight [kg]"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>mmfit <span class="ot">&lt;-</span> <span class="fu">glm</span>(weight_kg <span class="sc">~</span> age, <span class="at">data =</span> mm)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mmfit, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-stat25_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<div class="practice">
<p><strong>10M3.</strong> Below is a summary of a regression model for the data in 10M2, i.e., for men &lt; 50 years old. This time with the predictor centered at 20 years and expressed in decades: <span class="math inline">\(age20dec = (age - 20)/10\)</span>.</p>
<ol type="a">
<li><p>Given an approximate 95 % confidence around the regression coefficient for the age variable</p></li>
<li><p>In one sentence, describe how weight and age are related according to the regression model in terms of weight differences per decade, with reference to both point and interval estimate.</p></li>
<li><p>Reexpress (b), but now assume a causal relationship between age and weight.</p></li>
<li><p>Would you assess the size of the age-effect on weight to be reasonable? Discuss.</p></li>
</ol>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mm<span class="sc">$</span>age20dec <span class="ot">&lt;-</span> (mm<span class="sc">$</span>age <span class="sc">-</span> <span class="dv">20</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>mmfit <span class="ot">&lt;-</span> <span class="fu">glm</span>(weight_kg <span class="sc">~</span> age20dec, <span class="at">data =</span> mm)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mmfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = weight_kg ~ age20dec, data = mm)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  73.9696     1.0516   70.34  &lt; 2e-16 ***
age20dec      5.2100     0.7127    7.31 1.15e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 173.4478)

    Null deviance: 91309  on 474  degrees of freedom
Residual deviance: 82041  on 473  degrees of freedom
AIC: 3801

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p><br></p>
<div class="practice">
<p><strong>10M4.</strong> I wanted to explore whether smokers have lower weight than non-smokers. I used the data from above (earnings.txt, full sample) and used linear regression to fit this model:</p>
<p><span class="math display">\[weight_i \sim Normal(\mu_i, \sigma) \\
\mu_i= b_0 + b_1 smoke_i
\]</span></p>
<p>where <span class="math inline">\(weight\)</span> is in kg and <span class="math inline">\(smoke\)</span> is an indicator variable coded 1 if current smoker and 0 if not.</p>
<p>Below is a summary of the regression result. This time I used <code>stan_glm()</code> from the <code>rstanarm</code> package.</p>
<ol type="a">
<li><p>Explain the meaning of the three estimated parameter values: <span class="math inline">\(b_0, b_1, \sigma\)</span>.</p></li>
<li><p>Summarize the result in a single sentence with respect to the hypothesis that smokers have lower weight than non-smokers, refer to both point and interval estimates of the coefficient for smoke. Provide two versions: (1) In terms of differences between groups, and (2) in terms of causal effect.</p></li>
<li><p>The result was in the expected direction: smokers had lower weight than non-smokers in this sample. Still, the causal interpretation (b) may still be wrong. Discuss potential confounders (some available in the data set, see code book below).</p></li>
</ol>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Indicator-coded smoking variable: 1 if smoker (&lt;7 cigs a week), 0 if not.  </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># smokenow in the original data set was defined as 1 for more than 7 cigs per </span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># week, 2 if not.</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>smoke <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(m<span class="sc">$</span>smokenow <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model, note: refresh = 0 suppresses output to the console, not needed</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>smokefit <span class="ot">&lt;-</span> rstanarm<span class="sc">::</span><span class="fu">stan_glm</span>(weight_kg <span class="sc">~</span> smoke, <span class="at">data =</span> m, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(smokefit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      weight_kg ~ smoke
 observations: 1788
 predictors:   2
------
            Median MAD_SD
(Intercept) 71.4    0.4  
smoke       -2.0    0.9  

Auxiliary parameter(s):
      Median MAD_SD
sigma 15.7    0.3  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="hard" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="hard">Hard</h3>
<div class="practice">
<p><strong>10H1.</strong> This exercise is a version of Exercise 7.7 from <span class="citation" data-cites="gelman2020regression">Gelman et al. (<a href="references.html#ref-gelman2020regression" role="doc-biblioref">2021</a>)</span>:</p>
<p>Draw 100 values of the predictor x from a uniform distribution between 0 and 50. Then simulate 100 observations (<span class="math inline">\(y_i\)</span>, where <span class="math inline">\(i = 1, 2, ..., 100\)</span>) from this model:</p>
<p><span class="math inline">\(y_i \sim Normal(\mu_i = 2 + 5x_i, \sigma = 10)\)</span></p>
<p>Save <em>x</em> and <em>y</em> in a data frame called <code>fake</code> and fit the model</p>
<p><code>stan_glm(y ~ x, data = fake)</code> (or use <code>glm()</code> instead).</p>
<ol type="a">
<li>Plot data and regression line. Add regression equation to the plot.</li>
<li>Are the estimated coefficients close to the assumed true values? Discuss a way of defining “close” in this context.</li>
</ol>
</div>
<p><br></p>
<div class="practice">
<p><strong>10H2.</strong> This exercise is a version of Exercise 7.8 from <span class="citation" data-cites="gelman2020regression">Gelman et al. (<a href="references.html#ref-gelman2020regression" role="doc-biblioref">2021</a>)</span>:</p>
<p>Repeat the simulation in 10H1 a thousand times (omit plotting). Check that the coefficient estimates (<span class="math inline">\(b_0, b_1, \sigma\)</span>) are centered around the true parameter values.</p>
</div>
<p><br></p>
</section>
</section>
<section id="data-set-earnings.txt" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="data-set-earnings.txt">Data set earnings.txt</h2>
<p>The data set is from a survey on “Work, family, and well-being in the United States” conducted in 1990. Gelman <em>et al.</em> use it as several places, for example, pp.&nbsp;84-85 and 189-195. The data set provided by Gelman <em>et al</em>. is a selection of variables from the original study, and they have excluded respondents with missing data on height or earnings (see footnote 4, page 84). I managed to reconstruct a code book of the variables in the data set from the surveys code book, available at the Gelman <em>et al’s</em> web site.</p>
<p><br></p>
<p><strong>Code book</strong></p>
<ul>
<li><strong>height</strong> – Height [inches]</li>
<li><strong>weight</strong> – Wight [pounds]</li>
<li><strong>male</strong> – Sex: male = 1, female = 0</li>
<li><strong>earn</strong> – Personal income in 1989 before taxes [USD]</li>
<li><strong>earnk</strong> – Personal income in 1989 before taxes [kUSD]</li>
<li><strong>ethnicity</strong> – Black, Hispanic, White, or Other</li>
<li><strong>education</strong> – Highest grade or year of school:
<ul>
<li>0 None</li>
<li>1-8 Elementary school</li>
<li>9-12 High school</li>
<li>14-16 College</li>
<li>17 Some graduate school</li>
<li>18 Graduate or professional degree</li>
<li>99 Don’t know</li>
</ul></li>
<li><strong>mother_education</strong> – Highest grade or year of school mother. Code as for education.</li>
<li><strong>father_education</strong> – Highest grade or year of school father. Code as for education.</li>
<li><strong>walk</strong> – Frequency of talking a walk, including walking to work, train station, etc.
<ul>
<li>1 Never</li>
<li>2 Once a month or less</li>
<li>3 About twice a week</li>
<li>4 About once a week</li>
<li>5 Twice a week</li>
<li>6 Three times a week</li>
<li>7 More than 3 times a week</li>
<li>8 Every day</li>
</ul></li>
<li><strong>exercise</strong> – Frequency of strenuous exercising. A bit unclear how this was measured, but I guess it was a categorical scale from rarely (1) to often (7).</li>
<li><strong>smokenow</strong> – Smoke 7 or more cigarettes a week. 1 = yes, 2 = no.</li>
<li><strong>tense</strong> – On how many of the past 7 days have you felt tense or anxious? 0-7.</li>
<li><strong>angry</strong> – On how many of the past 7 days have you felt angry?</li>
<li><strong>age</strong> – Age [years]</li>
</ul>
<p><br></p>
<p><a href="https://bitbucket.org/matni/matni.bitbucket.org/raw/53f33eef6b43138812e5277fee3c2a106075d1cd/rmsnotes/datasets/earnings.txt" target="blank">Follow this link to find data</a> Save (Ctrl+S on a PC) to download as text file</p>
<p><br></p>
</section>
<section id="session-info" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="session-info">(Session Info)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 26100)

Matrix products: default


locale:
[1] LC_COLLATE=Swedish_Sweden.utf8  LC_CTYPE=Swedish_Sweden.utf8   
[3] LC_MONETARY=Swedish_Sweden.utf8 LC_NUMERIC=C                   
[5] LC_TIME=Swedish_Sweden.utf8    

time zone: Europe/Stockholm
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rstanarm_2.32.1 Rcpp_1.0.14    

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1     dplyr_1.1.4          farver_2.1.2        
 [4] loo_2.8.0            fastmap_1.2.0        tensorA_0.36.2.1    
 [7] shinystan_2.6.0      promises_1.3.3       shinyjs_2.1.0       
[10] digest_0.6.37        mime_0.13            lifecycle_1.0.4     
[13] StanHeaders_2.32.10  survival_3.7-0       magrittr_2.0.3      
[16] posterior_1.6.1      compiler_4.4.2       rlang_1.1.6         
[19] tools_4.4.2          igraph_2.1.4         yaml_2.3.10         
[22] knitr_1.50           htmlwidgets_1.6.4    pkgbuild_1.4.8      
[25] curl_6.4.0           plyr_1.8.9           RColorBrewer_1.1-3  
[28] dygraphs_1.1.1.6     abind_1.4-8          miniUI_0.1.2        
[31] grid_4.4.2           stats4_4.4.2         xts_0.14.1          
[34] xtable_1.8-4         inline_0.3.21        ggplot2_3.5.2       
[37] scales_1.4.0         gtools_3.9.5         MASS_7.3-61         
[40] cli_3.6.5            rmarkdown_2.29       reformulas_0.4.1    
[43] generics_0.1.4       RcppParallel_5.1.10  rstudioapi_0.17.1   
[46] reshape2_1.4.4       minqa_1.2.8          rstan_2.32.7        
[49] stringr_1.5.1        shinythemes_1.2.0    splines_4.4.2       
[52] bayesplot_1.13.0     parallel_4.4.2       matrixStats_1.5.0   
[55] base64enc_0.1-3      vctrs_0.6.5          V8_6.0.4            
[58] boot_1.3-31          Matrix_1.7-1         jsonlite_2.0.0      
[61] crosstalk_1.2.1      glue_1.8.0           nloptr_2.2.1        
[64] codetools_0.2-20     distributional_0.5.0 DT_0.33             
[67] stringi_1.8.7        gtable_0.3.6         later_1.4.2         
[70] QuickJSR_1.8.0       lme4_1.1-37          tibble_3.3.0        
[73] colourpicker_1.3.0   pillar_1.10.2        htmltools_0.5.8.1   
[76] R6_2.6.1             Rdpack_2.6.4         evaluate_1.0.3      
[79] shiny_1.11.1         lattice_0.22-6       markdown_2.0        
[82] rbibutils_2.3        backports_1.5.0      threejs_0.3.4       
[85] httpuv_1.6.16        rstantools_2.4.0     gridExtra_2.3       
[88] nlme_3.1-166         checkmate_2.3.2      xfun_0.52           
[91] zoo_1.8-14           pkgconfig_2.0.3     </code></pre>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-gelman2020regression" class="csl-entry" role="listitem">
Gelman, A., Hill, J., &amp; Vehtari, A. (2021). <em>Regression and other stories</em>. Cambridge University Press.
</div>
<div id="ref-McElreath2020" class="csl-entry" role="listitem">
McElreath, R. (2020). <em>Statistical rethinking: A bayesian course with examples in r and stan</em>. Chapman; Hall/CRC.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./09-method25.html" class="pagination-link" aria-label="M: Randomized Experiments">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">M: Randomized Experiments</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11-method25.html" class="pagination-link" aria-label="M: Broken Experiments and Quasi-experiments">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">M: Broken Experiments and Quasi-experiments</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>